language: go

go:
    - 1.11

install: skip
script: skip

jobs:
    include:
    - stage: test
      script:
      - export GO111MODULE=on
      - make dependencies
      - export GOOS=linux
      - export GOARCH=amd64
      - make test
    - stage: deploy
      if: tag IS present
      script:
      - export GO111MODULE=on
      - make dependencies
      - curl -fL https://getcli.jfrog.io | sh
      - export PATH=${TRAVIS_BUILD_DIR}:$PATH
      - export GOOS=linux
      - export GOARCH=amd64
      - make deploy
